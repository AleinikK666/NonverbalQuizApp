<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–í–ò–ó –ø–æ –ù–µ–≤–µ—Ä–±–∞–ª—å–Ω–æ–º—É –û–±—â–µ–Ω–∏—é ‚ú®</title>
    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —à—Ä–∏—Ñ—Ç–∞ Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f9fc;
        }
        .card {
            background-color: white;
            padding: 2rem;
            border-radius: 1.5rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }
        .btn-primary {
            background-color: #4f46e5;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            font-weight: 600;
            transition: background-color 0.3s ease, transform 0.1s;
        }
        .btn-primary:hover {
            background-color: #4338ca;
        }
        .btn-primary:active {
            transform: scale(0.98);
        }
        .btn-option {
            background-color: #edf2f7;
            border: 2px solid #e2e8f0;
            color: #1a202c;
            transition: background-color 0.2s, border-color 0.2s;
            text-align: left; 
            font-size: 1.5rem;
            display: flex;
            justify-content: center;
        }
        .btn-option:hover {
            background-color: #e2e8f0;
            border-color: #cbd5e0;
        }
        .btn-correct {
            background-color: #10b981;
            border-color: #059669;
            color: white;
        }
        .btn-incorrect {
            background-color: #ef4444;
            border-color: #dc2626;
            color: white;
        }
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #4f46e5;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .modal-overlay {
            background-color: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(2px);
        }
        /* –°—Ç–∏–ª—å –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –∏–≥—Ä–æ–∫–∞ –≤ —Ç–∞–±–ª–∏—Ü–µ –ª–∏–¥–µ—Ä–æ–≤ */
        .current-user-highlight {
            border: 3px solid #4f46e5; /* –ò–Ω–¥–∏–≥–æ–≤–∞—è —Ä–∞–º–∫–∞ */
            box-shadow: 0 4px 10px rgba(79, 70, 229, 0.3); /* –õ–µ–≥–∫–∞—è —Ç–µ–Ω—å */
        }
    </style>

    <!-- –°–∫—Ä–∏–ø—Ç—ã Firebase -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        // –î–û–ë–ê–í–õ–ï–ù signInWithCustomToken –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, getDoc, setDoc, onSnapshot, collection, query, orderBy } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // –í–∫–ª—é—á–∞–µ–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
        setLogLevel('Debug'); 

        const firebaseConfig = {
            apiKey: "AIzaSyBTLriyjr6oX63ctJk2eu0MzXuuzO2qcyk",
¬† ¬†         authDomain: "nonverbal-quiz-app.firebaseapp.com",
¬† ¬†         projectId: "nonverbal-quiz-app",
¬† ¬†         storageBucket: "nonverbal-quiz-app.firebasestorage.app",
¬† ¬†         messagingSenderId: "951436964969",
¬† ¬†         appId: "1:951436964969:web:d3485e0014d709977e9ef8"
        };
        const initialAuthToken = null; 
        
        
        
        
        // –ò—Å–ø–æ–ª—å–∑—É–µ–º appId –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ –±–∞–∑–µ
        const appId = 'nonverbal-quiz-v3'; 
        const totalLevels = 7; 
        
        let db = null;
        let auth = null;
        window.userId = null; 
        window.username = null;
        window.highScore = 0;
        window.leaderboardData = [];
        
        // --- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è ---
        
        function initFirebase() {
            const statusElement = document.getElementById('leaderboard-status');
            
            // –ï—Å–ª–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ (—á—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç –Ω–∞ GitHub Pages)
            if (!firebaseConfig) {
                statusElement.innerText = '‚ùå –û—à–∏–±–∫–∞: –ì–ª–æ–±–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Firebase –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞. –¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤ –±—É–¥–µ—Ç –æ—Ç–∫–ª—é—á–µ–Ω–∞.';
                statusElement.classList.add('text-red-600');
                // –ó–∞–ø—É—Å–∫–∞–µ–º UI –±–µ–∑ DB
                window.userId = crypto.randomUUID(); 
                renderScreen('login');
                return false;
            }

            try {
                const app = initializeApp(firebaseConfig);
                db = getFirestore(app);
                auth = getAuth(app);
                statusElement.innerText = 'üîó –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö...';
                
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º CustomToken, –µ—Å–ª–∏ –æ–Ω –¥–æ—Å—Ç—É–ø–µ–Ω (–¥–ª—è —Ç–µ–∫—É—â–µ–π —Å—Ä–µ–¥—ã), –∏–Ω–∞—á–µ –∞–Ω–æ–Ω–∏–º–Ω—ã–π –≤—Ö–æ–¥
                let authPromise;
                if (initialAuthToken) {
                    statusElement.innerText = 'üîó –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ —Ç–æ–∫–µ–Ω...';
                    authPromise = signInWithCustomToken(auth, initialAuthToken);
                } else {
                    // –≠–¢–û –í–ê–® –ú–ï–¢–û–î –ê–£–¢–ï–ù–¢–ò–§–ò–ö–ê–¶–ò–ò –î–õ–Ø GITHUB PAGES
                    statusElement.innerText = 'üîó –ê–Ω–æ–Ω–∏–º–Ω—ã–π –≤—Ö–æ–¥...';
                    authPromise = signInAnonymously(auth);
                }
                
                authPromise.then((userCredential) => {
                    const user = userCredential.user;
                    window.userId = user.uid;
                    statusElement.innerText = '‚úÖ Firebase –ø–æ–¥–∫–ª—é—á–µ–Ω. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...';
                    
                    // –ó–∞–ø—É—Å–∫–∞–µ–º —Å–ª—É—à–∞—Ç–µ–ª–µ–π –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—Ö–æ–¥–∞
                    loadUserProfile().then(() => {
                        initializeLeaderboardListener();
                        renderScreen('login');
                    });
                    
                }).catch((error) => {
                    console.error("–û—à–∏–±–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏:", error);
                    statusElement.innerText = '‚ùå –û—à–∏–±–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏. –¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞. (–ü—Ä–æ–±–ª–µ–º–∞ —Å –∫–ª—é—á–æ–º –∏–ª–∏ —Ä–µ—Ñ–µ—Ä–µ—Ä–æ–º).'; 
                    window.userId = crypto.randomUUID(); 
                    renderScreen('login');
                });
                return true;

            } catch (error) {
                console.error("–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Firebase:", error);
                statusElement.innerText = '‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Firebase. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏ –∫–æ–Ω—Å–æ–ª—å.';
                window.userId = crypto.randomUUID(); 
                renderScreen('login');
                return false;
            }
        }
        
        // --- –õ–æ–≥–∏–∫–∞ Firebase –∏ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ---
        
        async function loadUserProfile() {
            if (!db || !window.userId) return;
            // –ü—Ä–∏–≤–∞—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è –ª–∏—á–Ω–æ–≥–æ —Ä–µ–∫–æ—Ä–¥–∞ –∏ –∏–º–µ–Ω–∏
            // –ü—É—Ç—å: /artifacts/{appId}/users/{userId}/profile/data
            const userRef = doc(db, "artifacts", appId, "users", window.userId, "profile", "data");
            
            console.log("–ü—É—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è:", userRef.path); // –î–û–ë–ê–í–õ–ï–ù–û –õ–û–ì–ò–†–û–í–ê–ù–ò–ï
            
            try {
                const docSnap = await getDoc(userRef);
                if (docSnap.exists()) {
                    const data = docSnap.data();
                    window.username = data.username || null;
                    window.highScore = data.highScore || 0; 
                } else {
                    window.username = null;
                    window.highScore = 0;
                }
            } catch (e) {
                console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø—Ä–æ—Ñ–∏–ª—è:", e);
            }
        }

        async function saveUserProfile(username) {
            if (!db || !window.userId) {
                console.warn("–ü—Ä–æ–ø—É—Å–∫ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è: DB –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞.");
                window.username = username; // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ª–æ–∫–∞–ª—å–Ω–æ, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –∏–≥—Ä–∞—Ç—å
                return;
            }
            const userRef = doc(db, "artifacts", appId, "users", window.userId, "profile", "data");
            
            console.log("–ü—É—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è:", userRef.path); // –î–û–ë–ê–í–õ–ï–ù–û –õ–û–ì–ò–†–û–í–ê–ù–ò–ï
            
            try {
                await setDoc(userRef, { username: username, highScore: window.highScore || 0, userId: window.userId }, { merge: true });
                window.username = username;
                console.log("–ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω.");
            } catch (e) {
                console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è:", e);
            }
        }

        async function updateSharedScore(newScore) {
            if (!db || !window.userId || !window.username) {
                console.warn("–ü—Ä–æ–ø—É—Å–∫ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: DB –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏–ª–∏ –Ω–µ—Ç –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.");
                return;
            } 
            
            // 1. –û–±–Ω–æ–≤–ª—è–µ–º –ª–∏—á–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å (private data)
            const userProfileRef = doc(db, "artifacts", appId, "users", window.userId, "profile", "data");
            
            // 2. –û–±–Ω–æ–≤–ª—è–µ–º –ø—É–±–ª–∏—á–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –ª–∏–¥–µ—Ä–æ–≤ (public data)
            // –ü—É—Ç—å: /artifacts/{appId}/public/data/leaderboard/{userId}
            const scoreDocRef = doc(db, "artifacts", appId, "public", "data", "leaderboard", window.userId);
            const timestamp = new Date().toISOString();
            
            console.log("–ü—É—Ç—å –∑–∞–ø–∏—Å–∏ –≤ —Ç–∞–±–ª–∏—Ü—É –ª–∏–¥–µ—Ä–æ–≤:", scoreDocRef.path); // –î–û–ë–ê–í–õ–ï–ù–û –õ–û–ì–ò–†–û–í–ê–ù–ò–ï
            
            const isNewHighScore = newScore > window.highScore;
            if (isNewHighScore) {
                window.highScore = newScore; // –û–±–Ω–æ–≤–ª—è–µ–º –ª–∏—á–Ω—ã–π —Ä–µ–∫–æ—Ä–¥
            }

            try {
                // –û–±–Ω–æ–≤–ª—è–µ–º –ª–∏—á–Ω—ã–π —Ä–µ–∫–æ—Ä–¥ –≤ –ø—Ä–∏–≤–∞—Ç–Ω–æ–º –ø—Ä–æ—Ñ–∏–ª–µ
                await setDoc(userProfileRef, { highScore: window.highScore, username: window.username }, { merge: true });
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –ø—É–±–ª–∏—á–Ω—É—é –∑–∞–ø–∏—Å—å, —Å–æ—Ö—Ä–∞–Ω—è—è –õ–£–ß–®–ò–ô –°–ß–ï–¢ –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø (highScore)
                // –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ –ª–∏–¥–µ—Ä–æ–≤
                await setDoc(scoreDocRef, {
                    username: window.username,
                    score: newScore, // –¢–µ–∫—É—â–∏–π —Å—á–µ—Ç (–¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
                    userId: window.userId,
                    timestamp: timestamp,
                    highScore: window.highScore 
                }, { merge: true });
                console.log(`–û–±—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–ø–∏—Å–∞–Ω. –†–µ–∫–æ—Ä–¥: ${window.highScore}`);
            } catch(e) {
                console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø–∏—Å–∏ –æ–±—â–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:", e);
            }
        }
        
        function initializeLeaderboardListener() {
            if (!db) return;
            
            // –ó–∞–ø—Ä–æ—Å: –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ. –°–æ—Ä—Ç–∏—Ä–æ–≤–∫—É –±—É–¥–µ–º –¥–µ–ª–∞—Ç—å –≤ JS.
            // –ü—É—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏–∏: /artifacts/{appId}/public/data/leaderboard
            const q = query(
                collection(db, "artifacts", appId, "public", "data", "leaderboard")
                // orderBy("highScore", "desc") // –£–ë–†–ê–ù–û: –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–∞ –≤ JS, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –æ—à–∏–±–æ–∫ —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏
            );
            
            console.log("–ü—É—Ç—å –¥–ª—è —á—Ç–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã –ª–∏–¥–µ—Ä–æ–≤:", `artifacts/${appId}/public/data/leaderboard`); // –î–û–ë–ê–í–õ–ï–ù–û –õ–û–ì–ò–†–û–í–ê–ù–ò–ï

            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–ª—É—à–∞—Ç–µ–ª—å —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
            onSnapshot(q, (snapshot) => {
                window.leaderboardData = [];
                snapshot.forEach((doc) => {
                    window.leaderboardData.push(doc.data());
                });
                
                // –î–û–ë–ê–í–õ–ï–ù–û: –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ª–æ–∫–∞–ª—å–Ω–æ –≤ JavaScript
                // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ high-score –ø–æ —É–±—ã–≤–∞–Ω–∏—é
                window.leaderboardData.sort((a, b) => (b.highScore || 0) - (a.highScore || 0));

                console.log("–¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤ –æ–±–Ω–æ–≤–ª–µ–Ω–∞ (–æ–±—â–∞—è).");
                // –ï—Å–ª–∏ –º—ã –Ω–∞ —ç–∫—Ä–∞–Ω–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤, –æ–±–Ω–æ–≤–ª—è–µ–º –µ–≥–æ
                if (document.getElementById('results-screen').classList.contains('flex')) {
                    renderLeaderboard();
                }
            }, (error) => {
                console.error("–û—à–∏–±–∫–∞ –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã –ª–∏–¥–µ—Ä–æ–≤:", error);
            });
        }
        
        // --- –ü—É–ª –í–æ–ø—Ä–æ—Å–æ–≤ (—Å–æ–∫—Ä–∞—â–µ–Ω –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –º–µ—Å—Ç–∞, –Ω–æ –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ–ª–Ω—ã–π) ---
        
        const QUESTIONS = [
            { type: 'gesture', text: "–ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç –∂–µ—Å—Ç üëç?", cue: "–ñ–µ—Å—Ç", options: ["–ù–µ—É–¥–∞—á–∞", "–í–æ–ø—Ä–æ—Å", "–°–æ–≥–ª–∞—Å–∏–µ", "–û—Ç—Ä–∏—Ü–∞–Ω–∏–µ"], answer: "–°–æ–≥–ª–∞—Å–∏–µ" },
            { type: 'gesture', text: "–ñ–µ—Å—Ç üëã –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —É–±–µ–∂–¥–µ–Ω–∏—è, –æ–Ω –ø—ã—Ç–∞–µ—Ç—Å—è –ø–æ–∫–∞–∑–∞—Ç—å:", cue: "–ñ–µ—Å—Ç", options: ["–ê–≥—Ä–µ—Å—Å–∏—é", "–°–∞—Ä–∫–∞–∑–º", "–ß–µ—Å—Ç–Ω–æ—Å—Ç—å –∏ –æ—Ç–∫—Ä—ã—Ç–æ—Å—Ç—å", "–†–∞–∑–¥—Ä–∞–∂–µ–Ω–∏–µ"], answer: "–ß–µ—Å—Ç–Ω–æ—Å—Ç—å –∏ –æ—Ç–∫—Ä—ã—Ç–æ—Å—Ç—å" },
            { type: 'posture', text: "–ü–æ–∑–∞: –ß–µ–ª–æ–≤–µ–∫ —Å—Ç–æ–∏—Ç, —Å–∫—Ä–µ—Å—Ç–∏–≤ —Ä—É–∫–∏ –Ω–∞ –≥—Ä—É–¥–∏. –ß—Ç–æ —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç?", cue: "–ü–æ–∑–∞", options: ["–û—Ç–∫—Ä—ã—Ç–æ—Å—Ç—å", "–ó–∞—â–∏—Ç–∞, –Ω–µ—Å–æ–≥–ª–∞—Å–∏–µ", "–†–∞—Å—Å–ª–∞–±–ª–µ–Ω–∏–µ", "–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –¥–µ–π—Å—Ç–≤–∏—é"], answer: "–ó–∞—â–∏—Ç–∞, –Ω–µ—Å–æ–≥–ª–∞—Å–∏–µ" },
            { type: 'emoji_match', text: "–ö–∞–∫–æ–π —ç–º–æ–¥–∑–∏ –ª—É—á—à–µ –≤—Å–µ–≥–æ –ø–µ—Ä–µ–¥–∞–µ—Ç —ç–º–æ—Ü–∏—é '–ò—Å–∫—Ä–µ–Ω–Ω–µ–µ —Å–º—É—â–µ–Ω–∏–µ'?", cue: "–ú–∏–º–∏–∫–∞/–≠–º–æ—Ü–∏—è", options: ["üò†", "üôÑ", "üò≥", "ü•≥"], answer: "üò≥" }, 
            { type: 'decipher', text: "–ö–∞–∫—É—é —Ñ—Ä–∞–∑—É –∏–ª–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–µ—Ä–µ–¥–∞–µ—Ç –∫–æ–º–±–∏–Ω–∞—Ü–∏—è: ‚òïÔ∏èüìñüåßÔ∏è?", cue: "–î–µ—à–∏—Ñ—Ä–æ–≤–∫–∞", options: ["–°—Ä–æ—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞", "–£—é—Ç–Ω—ã–π –≤–µ—á–µ—Ä —Å –∫–Ω–∏–≥–æ–π", "–£–±–æ—Ä–∫–∞ –¥–æ–º–∞", "–ü—Ä–æ–≥—É–ª–∫–∞ –≤ –ø–∞—Ä–∫–µ"], answer: "–£—é—Ç–Ω—ã–π –≤–µ—á–µ—Ä —Å –∫–Ω–∏–≥–æ–π" },
            { type: 'other', text: "–ß—Ç–æ —Ç–∞–∫–æ–µ '–ü—Ä–æ–∫—Å–µ–º–∏–∫–∞'?", cue: "–¢–µ—Ä–º–∏–Ω", options: ["–ò–∑—É—á–µ–Ω–∏–µ –≥–æ–ª–æ—Å–∞", "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞/–¥–∏—Å—Ç–∞–Ω—Ü–∏–∏", "–ò–∑—É—á–µ–Ω–∏–µ –ø—Ä–∏–∫–æ—Å–Ω–æ–≤–µ–Ω–∏–π", "–ò–∑—É—á–µ–Ω–∏–µ –∑–∞–ø–∞—Ö–æ–≤"], answer: "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞/–¥–∏—Å—Ç–∞–Ω—Ü–∏–∏" },
            { type: 'situation_match', text: "–ù–∞–ø—Ä—è–∂–µ–Ω–Ω—ã–µ –ø–ª–µ—á–∏, —Å–∂–∞—Ç—ã–µ –≥—É–±—ã. –ö–∞–∫–∞—è —ç–º–æ—Ü–∏—è –ø—Ä–µ–æ–±–ª–∞–¥–∞–µ—Ç?", cue: "–°–∏—Ç—É–∞—Ü–∏—è", options: ["–†–∞–¥–æ—Å—Ç—å", "–£–¥–∏–≤–ª–µ–Ω–∏–µ", "–ì–Ω–µ–≤ –∏–ª–∏ —Å–∏–ª—å–Ω–æ–µ –±–µ—Å–ø–æ–∫–æ–π—Å—Ç–≤–æ", "–†–∞—Å—Å–ª–∞–±–ª–µ–Ω–∏–µ"], answer: "–ì–Ω–µ–≤ –∏–ª–∏ —Å–∏–ª—å–Ω–æ–µ –±–µ—Å–ø–æ–∫–æ–π—Å—Ç–≤–æ" },
        ];
        
        let currentQuestions = [];
        let currentQuestionIndex = 0;
        let score = 0;
        
        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (–Ω–µ –∏–∑–º–µ–Ω–µ–Ω—ã, –∫—Ä–æ–º–µ –≤—ã–∑–æ–≤–∞ clearLocalLeaderboard)
        function alertUser(message, confirmMode = false, onConfirm = () => {}) {
            const modal = document.getElementById('simple-alert-modal');
            const alertText = document.getElementById('simple-alert-text');
            const confirmBtn = document.getElementById('alert-confirm-btn');
            const closeBtn = document.getElementById('alert-close-btn');

            alertText.textContent = message;

            if (confirmMode) {
                confirmBtn.classList.remove('hidden');
                closeBtn.textContent = '–û—Ç–º–µ–Ω–∞';
                confirmBtn.onclick = () => {
                    onConfirm();
                    closeAlert();
                };
            } else {
                confirmBtn.classList.add('hidden');
                closeBtn.textContent = '–ü–æ–Ω—è—Ç–Ω–æ';
                closeBtn.onclick = closeAlert;
            }

            modal.classList.remove('hidden');
        }

        function closeAlert() {
             document.getElementById('simple-alert-modal').classList.add('hidden');
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                // –ò–°–ü–†–ê–í–õ–ï–ù–û: –î–æ–±–∞–≤–ª–µ–Ω—ã –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–µ —Å–∫–æ–±–∫–∏ –≤–æ–∫—Ä—É–≥ –ø—Ä–∞–≤–æ–≥–æ –æ–ø–µ—Ä–∞–Ω–¥–∞ –¥–ª—è –¥–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏–∏.
                [array[i], array[j]] = [array[j], array[i]]; 
            }
        }

        function initializeGame() {
            shuffleArray(QUESTIONS);
            currentQuestions = QUESTIONS.slice(0, totalLevels);
            currentQuestionIndex = 0;
            score = 0;
            renderQuestion();
        }
        
        // –§—É–Ω–∫—Ü–∏–∏ renderQuestion, checkAnswer, goToNextQuestion - –æ—Å—Ç–∞–ª–∏—Å—å –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
        function renderQuestion() {
            if (currentQuestionIndex >= totalLevels) {
                endGame();
                return;
            }
            
            const q = currentQuestions[currentQuestionIndex];
            const gameArea = document.getElementById('game-area');
            gameArea.innerHTML = '';
            
            const options = [...q.options];
            shuffleArray(options);
            
            const isEmojiQuestion = options.every(option => option.length <= 4 && (option.includes('Ô∏è') || /\p{Emoji_Presentation}/u.test(option)));


            const questionMarkup = `
                <div class="space-y-6">
                    <div class="flex justify-between items-center">
                        <div class="text-xs font-semibold uppercase text-indigo-600">
                            –£—Ä–æ–≤–µ–Ω—å ${currentQuestionIndex + 1} –∏–∑ ${totalLevels}
                        </div>
                        <div class="text-3xl font-extrabold text-gray-800">
                            –ë–∞–ª–ª—ã: ${score}
                        </div>
                    </div>
                    
                    <div class="bg-indigo-50 p-6 rounded-xl border border-indigo-200">
                        <p class="text-xl font-semibold text-gray-700 mb-2">
                            ${q.text}
                        </p>
                        <p class="text-sm italic text-indigo-800">
                            –ü–æ–¥—Å–∫–∞–∑–∫–∞ / –¢–∏–ø: ${q.cue}
                        </p>
                    </div>

                    <div id="options-container" class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-6">
                        ${options.map(option => `
                            <button class="btn-primary btn-option w-full py-4 px-6 text-lg font-medium ${isEmojiQuestion ? 'text-4xl' : 'text-lg text-left'}" 
                                data-answer="${option}" onclick="checkAnswer(this)">
                                ${option}
                            </button>
                        `).join('')}
                    </div>
                    <div id="feedback" class="h-10 mt-4 text-center font-bold text-lg"></div>
                    <button id="next-btn" class="btn-primary w-full opacity-0 pointer-events-none mt-4" onclick="goToNextQuestion()">
                        –°–ª–µ–¥—É—é—â–∏–π –í–æ–ø—Ä–æ—Å
                    </button>
                </div>
            `;
            
            gameArea.innerHTML = questionMarkup;
            renderScreen('game');
        }

        function checkAnswer(button) {
            const selectedAnswer = button.getAttribute('data-answer');
            const q = currentQuestions[currentQuestionIndex];
            const isCorrect = selectedAnswer === q.answer;
            const optionsContainer = document.getElementById('options-container');
            const feedback = document.getElementById('feedback');
            const nextBtn = document.getElementById('next-btn');

            Array.from(optionsContainer.children).forEach(btn => {
                btn.disabled = true;
                btn.classList.remove('btn-option', 'hover:bg-e2e8f0');
                if (btn.getAttribute('data-answer') === q.answer) {
                    btn.classList.add('btn-correct');
                } else if (btn.getAttribute('data-answer') === selectedAnswer) {
                    btn.classList.add('btn-incorrect');
                }
                
                if (btn.getAttribute('data-answer') !== q.answer && btn.getAttribute('data-answer') !== selectedAnswer) {
                     btn.classList.add('bg-gray-100', 'text-gray-400');
                }
            });

            if (isCorrect) {
                score += 10;
                feedback.innerHTML = '<span class="text-green-600">‚úÖ –í–µ—Ä–Ω–æ! +10 –±–∞–ª–ª–æ–≤.</span>';
                document.querySelector('.text-3xl').innerHTML = `–ë–∞–ª–ª—ã: ${score}`; 
            } else {
                feedback.innerHTML = `<span class="text-red-600">‚ùå –ù–µ–≤–µ—Ä–Ω–æ. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: ${q.answer}</span>`;
            }
            
            nextBtn.classList.remove('opacity-0', 'pointer-events-none');
        }
        
        function goToNextQuestion() {
            currentQuestionIndex++;
            renderQuestion();
        }
        // –ö–æ–Ω–µ—Ü –Ω–µ–∏–∑–º–µ–Ω–µ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –∏–≥—Ä—ã
        
        async function endGame() {
            const resultsScreen = document.getElementById('results-screen');
            
            // –ï—Å–ª–∏ DB –¥–æ—Å—Ç—É–ø–Ω–∞, —Å–æ—Ö—Ä–∞–Ω—è–µ–º –æ–±—â–∏–π —Å—á–µ—Ç
            if (db && window.username) {
                await updateSharedScore(score); 
            } else if (score > window.highScore) {
                 // –ï—Å–ª–∏ DB –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞, —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ
                 window.highScore = score;
            }
            
            const leaderboardStatus = db ? '–û–±—â–∞—è —Ç–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –∏–∑ Firebase.' : '‚ùå –û–±—â–∞—è —Ç–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ (–Ω–µ—Ç –∫–ª—é—á–µ–π Firebase).';

            resultsScreen.innerHTML = `
                <div class="text-center space-y-6">
                    <h2 class="text-5xl font-extrabold text-indigo-700">–ò–≥—Ä–∞ –ó–∞–≤–µ—Ä—à–µ–Ω–∞! üéâ</h2>
                    <p class="text-2xl text-gray-700">–í–∞—à —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:</p>
                    <div class="text-7xl font-bold text-indigo-900">${score}</div>
                    <p class="text-xl text-gray-600">–°–ø–∞—Å–∏–±–æ –∑–∞ –∏–≥—Ä—É, ${window.username || '–ò–≥—Ä–æ–∫'}!</p>
                    <div id="high-score-feedback" class="text-lg font-semibold ${score >= window.highScore ? 'text-green-600' : 'text-gray-500'}">
                        ${score >= window.highScore ? 
                            `üèÜ –ù–æ–≤—ã–π –ª–∏—á–Ω—ã–π —Ä–µ–∫–æ—Ä–¥! (${window.highScore} –±–∞–ª–ª–æ–≤)` : 
                            `–í–∞—à –ª—É—á—à–∏–π —Ä–µ–∫–æ—Ä–¥: ${window.highScore || 0} –±–∞–ª–ª–æ–≤`}
                    </div>
                    
                    <button id="restart-btn" class="btn-primary w-full" onclick="renderScreen('login')">
                        –ù–∞—á–∞—Ç—å –ù–æ–≤—É—é –ò–≥—Ä—É ‚ñ∂Ô∏è
                    </button>
                    
                    <div class="pt-8">
                        <h3 class="text-3xl font-bold text-gray-800 mb-4">–û–±—â–∞—è –¢–∞–±–ª–∏—Ü–∞ –õ–∏–¥–µ—Ä–æ–≤ ü•á</h3>
                        <div id="leaderboard-status" class="text-sm text-gray-500 mb-2">
                            ${leaderboardStatus}
                        </div>
                        <div id="leaderboard-list" class="space-y-2">
                            <!-- –°–ø–∏—Å–æ–∫ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –∑–¥–µ—Å—å —á–µ—Ä–µ–∑ renderLeaderboard -->
                        </div>
                    </div>
                </div>
            `;
            
            renderScreen('results');
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã (—Å—Ä–∞–±–æ—Ç–∞–µ—Ç —Å –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ window.leaderboardData)
            renderLeaderboard(); 
        }
        
        function renderLeaderboard() {
            const leaderboardList = document.getElementById('leaderboard-list');
            if (!leaderboardList) return;

            leaderboardList.innerHTML = '';
            
            window.leaderboardData.forEach((item, index) => {
                // –ï—Å–ª–∏ Firebase –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω, —Ç–æ window.userId –±—É–¥–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–º crypto.randomUUID(), 
                // —á—Ç–æ –≤—Å–µ —Ä–∞–≤–Ω–æ –±—É–¥–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –¥–ª—è —ç—Ç–æ–π —Å–µ—Å—Å–∏–∏.
                const isCurrentUser = item.userId === window.userId; 
                
                const displayScore = item.highScore || 0; 
                
                leaderboardList.innerHTML += `
                    <div class="flex justify-between items-center p-3 rounded-xl transition duration-150 
                                ${isCurrentUser ? 'bg-indigo-100 font-bold current-user-highlight' : 'bg-white border border-gray-200'}">
                        <span class="w-8 text-center">${index + 1}.</span>
                        <span class="flex-1 truncate mx-2">${isCurrentUser ? '‚≠ê –í—ã: ' : ''}${item.username}</span>
                        <span class="text-lg font-bold text-indigo-700">${displayScore}</span>
                    </div>
                `;
            });
        }


        // --- –õ–æ–≥–∏–∫–∞ UI –∏ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≠–∫—Ä–∞–Ω–æ–≤ ---

        function renderScreen(screenName) {
            const screens = ['loading-screen', 'login-screen', 'game-init-screen', 'game-screen', 'results-screen'];
            screens.forEach(id => {
                const screen = document.getElementById(id);
                if (screen) {
                    if (id === `${screenName}-screen` || (screenName === 'game-init' && id === 'game-init-screen')) {
                        screen.classList.remove('hidden');
                        screen.classList.add('flex');
                    } else {
                        screen.classList.add('hidden');
                        screen.classList.remove('flex');
                    }
                }
            });

            if (screenName === 'game-init') {
                initializeGame();
            } else if (screenName === 'login') {
                 document.getElementById('username-input').value = window.username || '';
                 document.getElementById('login-feedback').textContent = '';
            }
        }
        
        function handleLogin() {
            const usernameInput = document.getElementById('username-input');
            const username = usernameInput.value.trim();
            const loginFeedback = document.getElementById('login-feedback');
            
            if (username.length < 3) {
                loginFeedback.textContent = '–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ 3 —Å–∏–º–≤–æ–ª–æ–≤. ‚ö†Ô∏è';
                loginFeedback.classList.add('text-red-600');
                return;
            }
            
            loginFeedback.textContent = '–í—Ö–æ–¥... üöÄ';
            loginFeedback.classList.remove('text-red-600');

            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–º—è (–µ—Å–ª–∏ DB –¥–æ—Å—Ç—É–ø–Ω–∞, –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ, –∏–Ω–∞—á–µ —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è)
            saveUserProfile(username).then(() => {
                renderScreen('game-init');
            }).catch(e => {
                // –í —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ç—å—é), –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –∏–≥—Ä–∞—Ç—å
                console.error("–ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –∏–≥—Ä–∞—Ç—å, –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –æ—à–∏–±–∫—É —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è:", e);
                renderScreen('game-init');
            });
        }
        
        // –ù–∞–∑–Ω–∞—á–∞–µ–º –≥–ª–æ–±–∞–ª—å–Ω–æ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∏–∑ HTML
        window.initializeGame = initializeGame;
        window.checkAnswer = checkAnswer;
        window.goToNextQuestion = goToNextQuestion;
        window.handleLogin = handleLogin;
        window.renderScreen = renderScreen; 
        window.closeAlert = closeAlert;

        // –ù–∞—á–∏–Ω–∞–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é Firebase, —á—Ç–æ–±—ã –ø–æ–∫–∞–∑–∞—Ç—å —ç–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏
        window.onload = () => {
             renderScreen('loading');
             initFirebase();
        };

    </script>
</head>
<body class="min-h-screen flex items-center justify-center p-4">

    <!-- 1. –≠–∫—Ä–∞–Ω –ó–∞–≥—Ä—É–∑–∫–∏ -->
    <div id="loading-screen" class="absolute inset-0 bg-f7f9fc flex items-center justify-center z-10">
        <div class="flex flex-col items-center space-y-4">
            <div class="loader"></div>
            <p id="loading-message" class="text-xl text-gray-600">–ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö... ‚è≥</p>
            <p id="leaderboard-status" class="text-sm text-gray-400">–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Firebase...</p>
        </div>
    </div>

    <!-- 2. –≠–∫—Ä–∞–Ω –í—Ö–æ–¥–∞/–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
    <div id="login-screen" class="hidden w-full max-w-lg">
        <div class="card w-full text-center">
            <h1 class="text-4xl font-extrabold text-indigo-700 mb-4">–ö–í–ò–ó –ø–æ –ù–µ–≤–µ—Ä–±–∞–ª—å–Ω–æ–º—É –û–±—â–µ–Ω–∏—é ‚ú®</h1>
            <p class="text-lg text-gray-600 mb-8">
                –í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –∏–≥—Ä—É. üë§
            </p>
            
            <div class="space-y-4">
                <input type="text" id="username-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" 
                       class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:outline-none focus:border-indigo-500 text-lg" 
                       maxlength="20" onkeyup="if(event.key === 'Enter') handleLogin()">
                
                <button class="btn-primary w-full text-xl" onclick="handleLogin()">
                    –ù–∞—á–∞—Ç—å –ò–≥—Ä—É ‚ñ∂Ô∏è
                </button>
            </div>
            
            <p id="login-feedback" class="mt-4 text-sm font-medium text-gray-500 h-6"></p>
            
            <p class="mt-8 text-xs text-gray-500">
                –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –≤ –æ–±—â–µ–π —Ç–∞–±–ª–∏—Ü–µ –ª–∏–¥–µ—Ä–æ–≤.
            </p>
        </div>
    </div>

    <!-- 3. –≠–∫—Ä–∞–Ω –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ò–≥—Ä—ã (—Å–∫—Ä—ã—Ç, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ initializeGame) -->
    <div id="game-init-screen" class="hidden"></div>


    <!-- 4. –≠–∫—Ä–∞–Ω –ò–≥—Ä—ã -->
    <div id="game-screen" class="hidden w-full max-w-2xl">
        <div class="card w-full">
            <div id="game-area">
                <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤–æ–ø—Ä–æ—Å–∞ –∏ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–æ JS -->
            </div>
        </div>
    </div>

    <!-- 5. –≠–∫—Ä–∞–Ω –†–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤/–¢–∞–±–ª–∏—Ü–∞ –õ–∏–¥–µ—Ä–æ–≤ -->
    <div id="results-screen" class="hidden w-full max-w-lg">
        <div class="card w-full" id="results-card">
            <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏ —Ç–∞–±–ª–∏—Ü—ã –ª–∏–¥–µ—Ä–æ–≤ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–æ JS -->
        </div>
    </div>
    
    <!-- 6. –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ (–∑–∞–º–µ–Ω–∞ alert —Å confirm) -->
    <div id="simple-alert-modal" class="hidden fixed inset-0 flex items-center justify-center z-50 modal-overlay p-4">
        <div class="bg-white p-6 rounded-2xl shadow-2xl w-full max-w-sm transform transition-all duration-300 text-center">
            <p id="simple-alert-text" class="text-lg font-medium text-gray-800 mb-6"></p>
            <div class="flex justify-center space-x-4">
                <button id="alert-close-btn" class="py-2 px-4 bg-gray-200 text-gray-700 font-medium rounded-xl hover:bg-gray-300 transition duration-150" onclick="closeAlert()">
                    –ü–æ–Ω—è—Ç–Ω–æ
                </button>
                <button id="alert-confirm-btn" class="hidden py-2 px-4 bg-red-500 text-white font-medium rounded-xl hover:bg-red-600 transition duration-150">
                    –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å
                </button>
            </div>
        </div>
    </div>

</body>
</html>
